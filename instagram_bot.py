import os
import logging
import random
from flask import Flask
from threading import Thread
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, ContextTypes, filters
import yt_dlp
import asyncio

BOT_TOKEN = '8068187770:AAFgoNllhfi949EzgyPEz-WDyRk_u6-TGNs'

COOKIES_STRING = (
    "mid=Z-JcogALAAHBuU_jpo2DmCqHCKqB; "
    "datr=olziZyt4Xj82VkHmV3nmGF12; "
    "ig_did=A1F5CBE3-F0C5-4468-875E-E5415F9A1EE9; "
    "ig_nrcb=1; wd=1536x703; dpr=1.25; "
    "csrftoken=ONFysLggevyniNoB0MYrIJpBnyZ1JxFi; "
    "ds_user_id=48658772952; "
    "sessionid=48658772952%3AmOjL1NHJJqKhQD%3A1%3AAYd3dkzxBIdtR4lyhwufcOitx374P6dKNIXjBNnfvA; "
    "rur=RVA\05448658772952\0541779899514:01f7acbdb41a99e31f0fe7fec4eab2e290f5268bef2be7cb15b1128f687336341985b051"
)

logging.basicConfig(filename='bot_errors.log', level=logging.ERROR)

user_links_count = {}

before_download = [
    "üì• –í—ã—Å–∞—Å—ã–≤–∞—é —Ç–≤–æ–π Reels, –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–æ–∫ –∏–∑ —Ç—Ä—É–±–æ—á–∫–∏...",
"üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å –≤ –∫—Ä–∏–≤–æ–µ MP4, –∫–∞–∫ –Ω–∞—Å—Ç–æ—è—â–∏–π –≥–µ–Ω–∏–π...",
"‚åõ –ñ–¥–∏, –ø–æ–∫–∞ –∏–Ω—Å—Ç–∞–≥—Ä–∞–º –≤—ã–¥–∞—Å—Ç –º–Ω–µ —Ç–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ –±–æ–ª—å...",
"ü§ñ –ú–æ–∏ —Å–µ—Ä–≤–µ—Ä–∞ —Å—Ç–æ–Ω—É—Ç, –Ω–æ —Ç–µ—Ä–ø—è—Ç —Ä–∞–¥–∏ —Ç–≤–æ–µ–≥–æ –º–µ–º–∞...",
"üíæ –°–æ—Ö—Ä–∞–Ω—è—é –≤–∏–¥–µ–æ, –∞ –∑–∞–æ–¥–Ω–æ –∏ —Ç–≤–æ–∏ –≥—Ä–µ—Ö–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é...",
"üî• –ü—Ä–æ–∂–∏–≥–∞—é –¥—ã—Ä—É –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ —Ä–∞–¥–∏ —Ç–≤–æ–µ–≥–æ Reels...",
"‚ö° –£—Å–∫–æ—Ä—è—é –∑–∞–≥—Ä—É–∑–∫—É —Å–∏–ª–æ–π —á–∏—Å—Ç–æ–π –Ω–µ–Ω–∞–≤–∏—Å—Ç–∏...",
"üíÄ –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Å–∫–∞—á–∞–µ—Ç—Å—è, —è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ —Å–¥–∞—é—Å—å...",
"üñï –î–µ—Ä–∂–∏, –Ω–æ –∑–Ω–∞–π ‚Äî —Ç—ã –º–µ–Ω—è –∏–∑—Ä—è–¥–Ω–æ –¥–æ—Å—Ç–∞–ª...",
"ü§° –ì–æ—Ç–æ–≤–ª—é —Ç–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –ª—é–±–æ–≤—å—é (–Ω–æ —ç—Ç–æ –Ω–µ —Ç–æ—á–Ω–æ)...",
"üêå –ó–∞–≥—Ä—É–∂–∞—é —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é —É–ª–∏—Ç–∫–∏ –≤ —Å–ø—è—â–µ–º —Ä–µ–∂–∏–º–µ...",
"üßä –°–µ—Ä–≤–µ—Ä–∞ –∏–Ω—Å—Ç—ã —Å–µ–≥–æ–¥–Ω—è —Ö–æ–ª–æ–¥–Ω—ã–µ, –∫–∞–∫ —Ç–≤–æ–µ —Å–µ—Ä–¥—Ü–µ...",
"ü¶• –ñ–¥–∏, –ø–æ–∫–∞ –æ–±–µ–∑—å—è–Ω–∞ —Å –Ω–æ—É—Ç–±—É–∫–æ–º –∑–∞–∫–æ–Ω—á–∏—Ç —Ä–∞–±–æ—Ç—É...",
"üí© –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ (–Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ ‚Äî –∫–∞–∫ —É Nokia 3310)...",
"üöÄ –•–æ—Ç–µ–ª —Å–¥–µ–ª–∞—Ç—å –±—ã—Å—Ç—Ä–æ, –Ω–æ –∏–Ω—Å—Ç–∞–≥—Ä–∞–º ‚Äî –Ω–µ –∫–æ—Å–º–æ—Å...",
"üïµÔ∏è‚Äç‚ôÇÔ∏è –í–æ—Ä—É–µ–º —Ç–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏ —Å–≤–µ—Ç–µ –¥–Ω—è (—à—É—Ç–∫–∞... –∏–ª–∏ –Ω–µ—Ç)",
"üé¨ –¢–≤–æ–π Reels —É–∂–µ –ø–æ—á—Ç–∏ –≤ —Ç–æ–ø–µ (—Ç–æ–ø–∞ –º–æ–∏—Ö —Å—Ç—Ä–∞–¥–∞–Ω–∏–π)...",
"ü§è –©—è 10 —Å–µ–∫ –ø–æ–ª—É—á–∏—à—å —Å–≤–æ–µ –º–∏–∫—Ä–æ-–≤–∏–¥–µ–æ...",
"üëæ –í–∑–ª–∞–º—ã–≤–∞—é –º–∞—Ç—Ä–∏—Ü—É... –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∂–¥—É –∑–∞–≥—Ä—É–∑–∫–∏",
"üçø –ü–æ–ø–∫–æ—Ä–Ω –≥–æ—Ç–æ–≤, –∞ —Ç–≤–æ–µ –≤–∏–¥–µ–æ ‚Äî –ø–æ—á—Ç–∏..."
]

after_download = [
    "–ù—É —á—ë, –æ–ø—è—Ç—å —Å–≤–æ—é –¥–∏—á—å –∫–∞—á–∞–µ–º? –î–µ—Ä–∂–∏, –∫—Ä–µ—Ç–∏–Ω,",
"–û–ø–∞, –µ—â—ë –æ–¥–∏–Ω —à–µ–¥–µ–≤—Ä –¥–ª—è —Ç–≤–æ–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≥–æ–≤–Ω–∞,",
"–°–µ—Ä—å—ë–∑–Ω–æ? –≠—Ç–æ –≤–æ—Ç –ø—Ä—è–º–æ –≤–æ—Ç —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –±—ã–ª–æ –∫–∞—á–∞—Ç—å? –ù—É –æ–∫,",
"–í–æ—Ç —Ç–≤–æ–π –≤–∏–¥–æ—Å, –Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è —Å–≤–æ–∏–º –º—É—Å–æ—Ä–æ–º,",
"–û–ø—è—Ç—å? –î–∞ —Ç—ã, –±–ª—è, –∫–æ–Ω—á–µ–Ω—ã–π! –õ–∞–¥–Ω–æ, –¥–µ—Ä–∂–∏,",
"–ù—É —á—ë, –¥–æ–ª–±–æ—ë–±, —Å–∫–∞—á–∞–ª - —Ç–µ–ø–µ—Ä—å –∏–¥–∏ –≤–µ—à–∞–π —ç—Ç–æ –≤ —Å–≤–æ–π —Ç–≥-–∫–∞–Ω–∞–ª,",
"–ë–ª—è, –Ω—É —Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ? –í–æ—Ç, –≤–æ–∑—å–º–∏ –∏ –æ—Ç—ä–µ–±–∏—Å—å,",
"–¢—ã —Ä–µ–∞–ª—å–Ω–æ –¥—É–º–∞–µ—à—å —ç—Ç–æ—Ç –∫–ª–∏–ø —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç –≤ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏? –ù—É –æ–∫,",
"–õ–æ–≤–∏, –ø–∏–¥–æ—Ä. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –æ–ø—è—Ç—å –∫–æ—Ç–∏–∫–∏ - —è —Ç–µ–±—è –Ω–∞–π–¥—É,",
"–û, –¥–∞ —ç—Ç–æ –∂–µ —Ç–≤–æ–π 228-–π –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π —Ä–µ–ª—Å! –¢—ã —É–ø–æ—Ä–Ω—ã–π, –∫–∞–∫ —Ç–∞—Ä–∞–∫–∞–Ω,",
"–ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å –∏–¥–∏ –Ω–∞—Ö—É–π, —Ö–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è,",
"–û–ø—è—Ç—å –∏–Ω—Å—Ç–∞? –î–∞ —É —Ç–µ–±—è, —Å—É–∫–∞, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å,",
"–ù—É —á—ë, —Å–Ω–æ–≤–∞ —Ö—É–π–Ω—é –∫–∞–∫—É—é-—Ç–æ –∫–∞—á–∞–µ—à—å? –ù–∞, –¥–µ–≥–µ–Ω–µ—Ä–∞—Ç,",
"–û—á–µ—Ä–µ–¥–Ω–æ–π –≤–∏–¥–æ—Å –¥–ª—è —Ç–≤–æ–µ–≥–æ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Ä–∞—Ñ–æ–Ω–∞! –ñ–≥–∏,",
"–°–µ—Ä—å—ë–∑–Ω–æ? –ï—â—ë –æ–¥–∏–Ω —Ä–µ–ª—Å? –î–∞ —Ç—ã —Å–∫—Ä–æ–ª–ª–æ–∑–∞–≤—Ä,",
"–í–æ—Ç —Ç–≤–æ—ë –≥–æ–≤–Ω–æ... –æ–π, —Ç–æ –µ—Å—Ç—å '–∫–æ–Ω—Ç–µ–Ω—Ç'. –î–µ—Ä–∂–∏,",
"–û–ø—è—Ç—å? –°—É–∫–∞, –¥–∞ —Ç—ã –±–æ—Ç –∫–∞–∫–æ–π-—Ç–æ! –õ–∞–¥–Ω–æ, –ª–æ–≤–∏,",
"–ù—É —á—ë, –¥–µ–±–∏–ª, —Å–∫–∞—á–∞–ª - —Ç–µ–ø–µ—Ä—å –∏–¥–∏ —Å–ø–∞–º—å —ç—Ç–æ –≤–µ–∑–¥–µ,",
"–ë–ª—è, –Ω—É —Ö–≤–∞—Ç–∏—Ç —É–∂–µ! –í–æ—Ç —Ç–≤–æ–π –≤–∏–¥–æ—Å, –æ—Ç–≤–∞–ª–∏,",
"–¢—ã —Ä–µ–∞–ª—å–Ω–æ –¥—É–º–∞–µ—à—å —ç—Ç–æ—Ç —É—ë–±–∏—â–Ω—ã–π –∫–ª–∏–ø —Å—Ç–æ–∏—Ç –º–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏? –î–µ—Ä–∂–∏,",
"–õ–æ–≤–∏, –º—É–¥–∏–ª–∞. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –æ–ø—è—Ç—å —Ç–∞–Ω—Ü—ã - —è –≤ –±–∞–Ω—é,",
"–û, –¥–∞ —ç—Ç–æ –∂–µ —Ç–≤–æ–π 300-–π —Ä–µ–ª—Å! –¢—ã, –±–ª—è—Ç—å, –º–æ–Ω—Å—Ç—Ä,",
"–ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å –∏–¥–∏ –Ω–∞—Ö—É–π –∏ –Ω–µ –±–µ—Å–ø–æ–∫–æ–π 5 –º–∏–Ω—É—Ç,",
"–û–ø—è—Ç—å –∏–Ω—Å—Ç–∞? –î–∞ —Ç—ã, —Å—É–∫–∞, –∫–∞–∫ –Ω–∞—Ä–∫–æ–º–∞–Ω,",
"–ù—É —á—ë, —Å–Ω–æ–≤–∞ –∫–∞–∫—É—é-—Ç–æ –¥–∏—á—å –∫–∞—á–∞–µ–º? –ù–∞, –∏–¥–∏–æ—Ç,",
"–û–ø–∞, –æ—á–µ—Ä–µ–¥–Ω–æ–π —à–µ–¥–µ–≤—Ä –¥–ª—è —Ç–≤–æ–µ–π –ø–æ–º–æ–π–∫–∏! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è,",
"–°–µ—Ä—å—ë–∑–Ω–æ? –≠—Ç–æ –≤–æ—Ç –ø—Ä—è–º–æ –≤–æ—Ç —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –±—ã–ª–æ? –ù—É –æ–∫–µ–π,",
"–í–æ—Ç —Ç–≤–æ–π '–∫–æ–Ω—Ç–µ–Ω—Ç'. –í—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –º—É—Å–æ—Ä, –Ω–æ —Ç–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—Å—è,",
"–û–ø—è—Ç—å? –î–∞ —Ç—ã, –±–ª—è, –±–µ–∑–±–∞—à–µ–Ω–Ω—ã–π! –õ–∞–¥–Ω–æ, –¥–µ—Ä–∂–∏,",
"–ù—É —á—ë, –¥–µ–≥–µ–Ω–µ—Ä–∞—Ç, —Å–∫–∞—á–∞–ª - —Ç–µ–ø–µ—Ä—å –∏–¥–∏ –≤–µ—à–∞–π –∫—É–¥–∞ —Ö–æ—á–µ—à—å,",
"–ë–ª—è, –Ω—É —Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ? –í–æ—Ç, –≤–æ–∑—å–º–∏ –∏ –æ—Ç—ä–µ–±–∏—Å—å –Ω–∞ –ø–æ–ª—á–∞—Å–∞,",
"–¢—ã —Ä–µ–∞–ª—å–Ω–æ –¥—É–º–∞–µ—à—å —ç—Ç–æ—Ç –∫–ª–∏–ø —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç? –ù—É –¥–µ—Ä–∂–∏,",
"–õ–æ–≤–∏, –∫—Ä–µ—Ç–∏–Ω. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –æ–ø—è—Ç—å –∫–æ—Ç–∏–∫–∏ - —è –≤ –∞—Ö—É–µ,",
"–û, –¥–∞ —ç—Ç–æ –∂–µ —Ç–≤–æ–π 500-–π —Ä–µ–ª—Å! –¢—ã, –±–ª—è—Ç—å, –º–∞—à–∏–Ω–∞,",
"–ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å –∏–¥–∏ –Ω–∞—Ö—É–π, —Ö–æ—Ä–æ—à–µ–≥–æ –≤–µ—á–µ—Ä–∞,",
"–û–ø—è—Ç—å –∏–Ω—Å—Ç–∞? –î–∞ —Ç—ã, —Å—É–∫–∞, –∫–∞–∫ —Ä–æ–±–æ—Ç,",
"–ù—É —á—ë, –æ–ø—è—Ç—å —Å–≤–æ—é —Ö—É–π–Ω—é –∫–∞—á–∞–µ–º? –ù–∞, –º—É–¥–∞–∫,",
"–û—á–µ—Ä–µ–¥–Ω–æ–π –≤–∏–¥–æ—Å –¥–ª—è —Ç–≤–æ–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –º—É—Å–æ—Ä–∞! –ñ–≥–∏,",
"–°–µ—Ä—å—ë–∑–Ω–æ? –ï—â—ë –æ–¥–∏–Ω? –î–∞ —Ç—ã —Å–∫—Ä–æ–ª–ª–æ–º–∞–Ω—å—è–∫,",
"–í–æ—Ç —Ç–≤–æ—ë –≥–æ–≤–Ω–æ... –æ–π, '–≤–∏–¥–µ–æ'. –î–µ—Ä–∂–∏,",
"–û–ø—è—Ç—å? –°—É–∫–∞, –¥–∞ —Ç—ã —Å–ø–∞–º–µ—Ä! –õ–∞–¥–Ω–æ, –ª–æ–≤–∏,",
"–ù—É —á—ë, –∏–¥–∏–æ—Ç, —Å–∫–∞—á–∞–ª - —Ç–µ–ø–µ—Ä—å –∏–¥–∏ —Å–ø–∞–º—å,",
"–ë–ª—è, –Ω—É —Ö–≤–∞—Ç–∏—Ç! –í–æ—Ç —Ç–≤–æ–π –≤–∏–¥–æ—Å, –æ—Ç—ä–µ–±–∏—Å—å,",
"–¢—ã —Ä–µ–∞–ª—å–Ω–æ –¥—É–º–∞–µ—à—å —ç—Ç–æ—Ç –∫–ª–∏–ø —Å—Ç–æ–∏—Ç –≤—Ä–µ–º–µ–Ω–∏? –ù—É –æ–∫,",
"–õ–æ–≤–∏, –¥–µ–±–∏–ª. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –æ–ø—è—Ç—å –º–µ–º—ã - —è –≤ —à–æ–∫–µ,",
"–û, –¥–∞ —ç—Ç–æ –∂–µ —Ç–≤–æ–π 1000-–π —Ä–µ–ª—Å! –¢—ã –ª–µ–≥–µ–Ω–¥–∞,",
"–ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å –∏–¥–∏ –Ω–∞—Ö—É–π, –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞,",
"–û–ø—è—Ç—å –∏–Ω—Å—Ç–∞? –î–∞ —Ç—ã, —Å—É–∫–∞, –∫–∞–∫ –∑–æ–º–±–∏,",
"–ù—É —á—ë, —Å–Ω–æ–≤–∞ –∫–∞–∫—É—é-—Ç–æ –¥–∏—á—å –∫–∞—á–∞–µ–º? –ù–∞, –¥–æ–ª–±–∞—ë–±,",
"–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –∫–∞—á–∞—é, –±–ª—è–¥—å! (—à—É—á—É, –∫–∏–¥–∞–π –µ—â—ë),",
]

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("üëã –ü—Ä–∏–≤–µ—Ç! –û—Ç–ø—Ä–∞–≤—å —Å—Å—ã–ª–∫—É –∏–∑ Instagram.", reply_markup=ReplyKeyboardMarkup([["/help"]], resize_keyboard=True))

async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("üì• –û—Ç–ø—Ä–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø–æ—Å—Ç –∏–ª–∏ Reels –∏–∑ Instagram, –∏ —è —Å–∫–∞—á–∞—é –≤–∏–¥–µ–æ –¥–ª—è —Ç–µ–±—è.")

async def handle_link(update: Update, context: ContextTypes.DEFAULT_TYPE):
    url = update.message.text.strip()
    user_id = update.message.from_user.id

    if "instagram.com" not in url:
        await update.message.reply_text("‚ö†Ô∏è –≠—Ç–æ –Ω–µ Instagram-—Å—Å—ã–ª–∫–∞.")
        return

    user_links_count[user_id] = user_links_count.get(user_id, 0) + 1
    if user_links_count[user_id] >= 5:
        await update.message.reply_text("üß† –ë—Ä–æ, –æ—Ç–¥–æ—Ö–Ω–∏ –æ—Ç Instagram –Ω–∞ –ø–∞—Ä—É –º–∏–Ω—É—Ç üòÑ")
        return

    await update.message.reply_text(random.choice(before_download))

    try:
        ydl_opts = {
            'outtmpl': 'insta_video.mp4',
            'format': 'mp4',
            'quiet': True,
            'noplaylist': True,
            'http_headers': {
                'User-Agent': 'Mozilla/5.0',
                'Accept-Language': 'en-US,en;q=0.9',
                'Cookie': COOKIES_STRING
            }
        }

        with yt_dlp.YoutubeDL(ydl_opts) as ydl:
            ydl.download([url])

        if os.path.getsize("insta_video.mp4") > 50_000_000:
            os.remove("insta_video.mp4")
            await update.message.reply_text("‚ö†Ô∏è –í–∏–¥–µ–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ –¥–ª—è Telegram (>50MB).")
            return

        with open("insta_video.mp4", "rb") as f:
            await update.message.reply_video(f)
        os.remove("insta_video.mp4")
        await update.message.reply_text(random.choice(after_download))

    except Exception as e:
        logging.error(str(e))
        await update.message.reply_text("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ. –ü—Ä–æ–≤–µ—Ä—å —Å—Å—ã–ª–∫—É –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ.")

flask_app = Flask(__name__)

@flask_app.route('/')
def home():
    return "‚úÖ –ë–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!"

def run_flask():
    flask_app.run(host="0.0.0.0", port=8000)

def run():
    app = ApplicationBuilder().token(BOT_TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("help", help_command))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_link))
    app.run_polling()

if __name__ == '__main__':
    Thread(target=run_flask, daemon=True).start()
    run()
