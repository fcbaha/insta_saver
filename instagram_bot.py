import os
import logging
import random
from flask import Flask
from threading import Thread
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, ContextTypes, filters
import yt_dlp
import asyncio

BOT_TOKEN = os.environ.get("BOT_TOKEN")



COOKIES_STRING = (
    "mid=Z-JcogALAAHBuU_jpo2DmCqHCKqB; "
    "datr=olziZyt4Xj82VkHmV3nmGF12; "
    "ig_did=A1F5CBE3-F0C5-4468-875E-E5415F9A1EE9; "
    "ig_nrcb=1; wd=1536x703; dpr=1.25; "
    "csrftoken=ONFysLggevyniNoB0MYrIJpBnyZ1JxFi; "
    "ds_user_id=48658772952; "
    "sessionid=48658772952%3AmOjL1NHJJqKhQD%3A1%3AAYd3dkzxBIdtR4lyhwufcOitx374P6dKNIXjBNnfvA; "
    "rur=RVA\05448658772952\0541779899514:01f7acbdb41a99e31f0fe7fec4eab2e290f5268bef2be7cb15b1128f687336341985b051"
)

logging.basicConfig(filename='bot_errors.log', level=logging.ERROR)

user_links_count = {}

before_download = [
    "üì• –í—ã—Å–∞—Å—ã–≤–∞—é —Ç–≤–æ–π Reels, –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–æ–∫ –∏–∑ —Ç—Ä—É–±–æ—á–∫–∏...",
"üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å –≤ –∫—Ä–∏–≤–æ–µ MP4, –∫–∞–∫ –Ω–∞—Å—Ç–æ—è—â–∏–π –≥–µ–Ω–∏–π...",
"‚åõ –ñ–¥–∏, –ø–æ–∫–∞ –∏–Ω—Å—Ç–∞–≥—Ä–∞–º –≤—ã–¥–∞—Å—Ç –º–Ω–µ —Ç–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ –±–æ–ª—å...",
"ü§ñ –ú–æ–∏ —Å–µ—Ä–≤–µ—Ä–∞ —Å—Ç–æ–Ω—É—Ç, –Ω–æ —Ç–µ—Ä–ø—è—Ç —Ä–∞–¥–∏ —Ç–≤–æ–µ–≥–æ –º–µ–º–∞...",
"üíæ –°–æ—Ö—Ä–∞–Ω—è—é –≤–∏–¥–µ–æ, –∞ –∑–∞–æ–¥–Ω–æ –∏ —Ç–≤–æ–∏ –≥—Ä–µ—Ö–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é...",
"üî• –ü—Ä–æ–∂–∏–≥–∞—é –¥—ã—Ä—É –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ —Ä–∞–¥–∏ —Ç–≤–æ–µ–≥–æ Reels...",
"‚ö° –£—Å–∫–æ—Ä—è—é –∑–∞–≥—Ä—É–∑–∫—É —Å–∏–ª–æ–π —á–∏—Å—Ç–æ–π –Ω–µ–Ω–∞–≤–∏—Å—Ç–∏...",
"üíÄ –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Å–∫–∞—á–∞–µ—Ç—Å—è, —è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ —Å–¥–∞—é—Å—å...",
"üñï –î–µ—Ä–∂–∏, –Ω–æ –∑–Ω–∞–π ‚Äî —Ç—ã –º–µ–Ω—è –∏–∑—Ä—è–¥–Ω–æ –¥–æ—Å—Ç–∞–ª...",
"ü§° –ì–æ—Ç–æ–≤–ª—é —Ç–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –ª—é–±–æ–≤—å—é (–Ω–æ —ç—Ç–æ –Ω–µ —Ç–æ—á–Ω–æ)...",
"üêå –ó–∞–≥—Ä—É–∂–∞—é —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é —É–ª–∏—Ç–∫–∏ –≤ —Å–ø—è—â–µ–º —Ä–µ–∂–∏–º–µ...",
"üßä –°–µ—Ä–≤–µ—Ä–∞ –∏–Ω—Å—Ç—ã —Å–µ–≥–æ–¥–Ω—è —Ö–æ–ª–æ–¥–Ω—ã–µ, –∫–∞–∫ —Ç–≤–æ–µ —Å–µ—Ä–¥—Ü–µ...",
"ü¶• –ñ–¥–∏, –ø–æ–∫–∞ –æ–±–µ–∑—å—è–Ω–∞ —Å –Ω–æ—É—Ç–±—É–∫–æ–º –∑–∞–∫–æ–Ω—á–∏—Ç —Ä–∞–±–æ—Ç—É...",
"üí© –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ (–Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ ‚Äî –∫–∞–∫ —É Nokia 3310)...",
"üöÄ –•–æ—Ç–µ–ª —Å–¥–µ–ª–∞—Ç—å –±—ã—Å—Ç—Ä–æ, –Ω–æ –∏–Ω—Å—Ç–∞–≥—Ä–∞–º ‚Äî –Ω–µ –∫–æ—Å–º–æ—Å...",
"üïµÔ∏è‚Äç‚ôÇÔ∏è –í–æ—Ä—É–µ–º —Ç–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏ —Å–≤–µ—Ç–µ –¥–Ω—è (—à—É—Ç–∫–∞... –∏–ª–∏ –Ω–µ—Ç)",
"üé¨ –¢–≤–æ–π Reels —É–∂–µ –ø–æ—á—Ç–∏ –≤ —Ç–æ–ø–µ (—Ç–æ–ø–∞ –º–æ–∏—Ö —Å—Ç—Ä–∞–¥–∞–Ω–∏–π)...",
"ü§è –©—è 10 —Å–µ–∫ –ø–æ–ª—É—á–∏—à—å —Å–≤–æ–µ —Ç—É–ø–æ–µ-–≤–∏–¥–µ–æ...",
"üëæ –í–∑–ª–∞–º—ã–≤–∞—é –º–∞—Ç—Ä–∏—Ü—É... –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∂–¥—É –∑–∞–≥—Ä—É–∑–∫–∏",
"üçø –ü–æ–ø–∫–æ—Ä–Ω –≥–æ—Ç–æ–≤, –∞ —Ç–≤–æ–µ –≤–∏–¥–µ–æ ‚Äî –ø–æ—á—Ç–∏..."
]

after_download = [
    "–ù—É —á—ë, –æ–ø—è—Ç—å —Å–≤–æ—é –¥–∏—á—å –∫–∞—á–∞–µ–º? –î–µ—Ä–∂–∏, –∫—Ä–µ—Ç–∏–Ω,",
"–û–ø–∞, –µ—â—ë –æ–¥–∏–Ω —à–µ–¥–µ–≤—Ä –¥–ª—è —Ç–≤–æ–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≥–æ–≤–Ω–∞,",
"–°–µ—Ä—å—ë–∑–Ω–æ? –≠—Ç–æ –≤–æ—Ç –ø—Ä—è–º–æ –≤–æ—Ç —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –±—ã–ª–æ –∫–∞—á–∞—Ç—å? –ù—É –æ–∫,",
"–í–æ—Ç —Ç–≤–æ–π –≤–∏–¥–æ—Å, –Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è —Å–≤–æ–∏–º –º—É—Å–æ—Ä–æ–º,",
"–û–ø—è—Ç—å? –î–∞ —Ç—ã, –±–ª—è, –∫–æ–Ω—á–µ–Ω—ã–π! –õ–∞–¥–Ω–æ, –¥–µ—Ä–∂–∏,",
"–ù—É —á—ë, –¥–µ–±–∏–ª, —Å–∫–∞—á–∞–ª - —Ç–µ–ø–µ—Ä—å –∏–¥–∏ –≤–µ—à–∞–π —ç—Ç–æ –≤ —Å–≤–æ–π —Ç–≥-–∫–∞–Ω–∞–ª,",
"–ë–ª—è, –Ω—É —Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ? –í–æ—Ç, –≤–æ–∑—å–º–∏ –∏ –æ—Ç—ä–µ–±–∏—Å—å,",
"–¢—ã —Ä–µ–∞–ª—å–Ω–æ –¥—É–º–∞–µ—à—å —ç—Ç–æ—Ç –∫–ª–∏–ø —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç –≤ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏? –ù—É –æ–∫,",
"–õ–æ–≤–∏, —á—ë—Ä—Ç. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –æ–ø—è—Ç—å –∫–æ—Ç–∏–∫–∏ - —è —Ç–µ–±—è –Ω–∞–π–¥—É,",
"–û, –¥–∞ —ç—Ç–æ –∂–µ —Ç–≤–æ–π 228-–π –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π —Ä–µ–ª—Å! –¢—ã —É–ø–æ—Ä–Ω—ã–π, –∫–∞–∫ —Ç–∞—Ä–∞–∫–∞–Ω,",
"–ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å –∏–¥–∏ –Ω–∞—Ö—É–π, —Ö–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è,",
"–û–ø—è—Ç—å –∏–Ω—Å—Ç–∞? –î–∞ —É —Ç–µ–±—è, —Å—É–∫–∞, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å,",
"–ù—É —á—ë, —Å–Ω–æ–≤–∞ —Ö—É–π–Ω—é –∫–∞–∫—É—é-—Ç–æ –∫–∞—á–∞–µ—à—å? –ù–∞, –¥–µ–≥–µ–Ω–µ—Ä–∞—Ç,",
"–û—á–µ—Ä–µ–¥–Ω–æ–π –≤–∏–¥–æ—Å –¥–ª—è —Ç–≤–æ–µ–≥–æ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–∞—Ä–∞—Ñ–æ–Ω–∞! –ñ–≥–∏,",
"–°–µ—Ä—å—ë–∑–Ω–æ? –ï—â—ë –æ–¥–∏–Ω —Ä–µ–ª—Å? –î–∞ —Ç—ã —Å–∫—Ä–æ–ª–ª–æ–∑–∞–≤—Ä,",
"–í–æ—Ç —Ç–≤–æ—ë –≥–æ–≤–Ω–æ... –æ–π, —Ç–æ –µ—Å—Ç—å '–∫–æ–Ω—Ç–µ–Ω—Ç'. –î–µ—Ä–∂–∏,",
"–û–ø—è—Ç—å? –°—É–∫–∞, –¥–∞ —Ç—ã –∑–∞–µ–±–∞–ª! –õ–∞–¥–Ω–æ, –ª–æ–≤–∏,",
"–ù—É —á—ë, –¥–µ–±–∏–ª, —Å–∫–∞—á–∞–ª - —Ç–µ–ø–µ—Ä—å –∏–¥–∏ —Å–ø–∞–º—å —ç—Ç–æ –≤–µ–∑–¥–µ,",
"–ë–ª—è, –Ω—É —Ö–≤–∞—Ç–∏—Ç —É–∂–µ! –í–æ—Ç —Ç–≤–æ–π –≤–∏–¥–æ—Å, –æ—Ç–≤–∞–ª–∏,",
"–¢—ã —Ä–µ–∞–ª—å–Ω–æ –¥—É–º–∞–µ—à—å —ç—Ç–æ—Ç —É—ë–±–∏—â–Ω—ã–π –∫–ª–∏–ø —Å—Ç–æ–∏—Ç –º–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏? –î–µ—Ä–∂–∏,",
"–õ–æ–≤–∏, –º—É–¥–∏–ª–∞. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –æ–ø—è—Ç—å —Ç–∞–Ω—Ü—ã - —è –≤ –±–∞–Ω—é,",
"–û, –¥–∞ —ç—Ç–æ –∂–µ —Ç–≤–æ–π 300-–π —Ä–µ–ª—Å! –¢—ã, –±–ª—è—Ç—å, –º–æ–Ω—Å—Ç—Ä,",
"–ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å –∏–¥–∏ –Ω–∞—Ö—É–π –∏ –Ω–µ –±–µ—Å–ø–æ–∫–æ–π 5 –º–∏–Ω—É—Ç,",
"–û–ø—è—Ç—å –∏–Ω—Å—Ç–∞? –î–∞ —Ç—ã, —Å—É–∫–∞, –∫–∞–∫ –Ω–∞—Ä–∫–æ–º–∞–Ω,",
"–ù—É —á—ë, —Å–Ω–æ–≤–∞ –∫–∞–∫—É—é-—Ç–æ –¥–∏—á—å –∫–∞—á–∞–µ–º? –ù–∞, –∏–¥–∏–æ—Ç,",
"–û–ø–∞, –æ—á–µ—Ä–µ–¥–Ω–æ–π —à–µ–¥–µ–≤—Ä –¥–ª—è —Ç–≤–æ–µ–π –ø–æ–º–æ–π–∫–∏! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è,",
"–°–µ—Ä—å—ë–∑–Ω–æ? –≠—Ç–æ –≤–æ—Ç –ø—Ä—è–º–æ –≤–æ—Ç —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ –±—ã–ª–æ? –ù—É –æ–∫–µ–π,",
"–í–æ—Ç —Ç–≤–æ–π '–∫–æ–Ω—Ç–µ–Ω—Ç'. –í—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –º—É—Å–æ—Ä, –Ω–æ —Ç–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—Å—è,",
"–û–ø—è—Ç—å? –î–∞ —Ç—ã, –±–ª—è, –±–µ–∑–±–∞—à–µ–Ω–Ω—ã–π! –õ–∞–¥–Ω–æ, –¥–µ—Ä–∂–∏,",
"–ù—É —á—ë, –¥–µ–≥–µ–Ω–µ—Ä–∞—Ç, —Å–∫–∞—á–∞–ª - —Ç–µ–ø–µ—Ä—å –∏–¥–∏ –≤–µ—à–∞–π –∫—É–¥–∞ —Ö–æ—á–µ—à—å,",
"–ë–ª—è, –Ω—É —Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ? –í–æ—Ç, –≤–æ–∑—å–º–∏ –∏ –æ—Ç—ä–µ–±–∏—Å—å –Ω–∞ –ø–æ–ª—á–∞—Å–∞,",
"–¢—ã —Ä–µ–∞–ª—å–Ω–æ –¥—É–º–∞–µ—à—å —ç—Ç–æ—Ç –∫–ª–∏–ø —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç? –ù—É –¥–µ—Ä–∂–∏,",
"–õ–æ–≤–∏, –∫—Ä–µ—Ç–∏–Ω. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –æ–ø—è—Ç—å –∫–æ—Ç–∏–∫–∏ - —è –≤ –∞—Ö—É–µ,",
"–û, –¥–∞ —ç—Ç–æ –∂–µ —Ç–≤–æ–π 500-–π —Ä–µ–ª—Å! –¢—ã, –±–ª—è—Ç—å, –º–∞—à–∏–Ω–∞,",
"–ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å –∏–¥–∏ –Ω–∞—Ö—É–π, —Ö–æ—Ä–æ—à–µ–≥–æ –≤–µ—á–µ—Ä–∞,",
"–û–ø—è—Ç—å –∏–Ω—Å—Ç–∞? –î–∞ —Ç—ã, —Å—É–∫–∞, –∫–∞–∫ —Ä–æ–±–æ—Ç,",
"–ù—É —á—ë, –æ–ø—è—Ç—å —Å–≤–æ—é —Ö—É–π–Ω—é –∫–∞—á–∞–µ–º? –ù–∞, –º—É–¥–∞–∫,",
"–û—á–µ—Ä–µ–¥–Ω–æ–π –≤–∏–¥–æ—Å –¥–ª—è —Ç–≤–æ–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –º—É—Å–æ—Ä–∞! –ñ–≥–∏,",
"–°–µ—Ä—å—ë–∑–Ω–æ? –ï—â—ë –æ–¥–∏–Ω? –î–∞ —Ç—ã —Å–∫—Ä–æ–ª–ª–æ–º–∞–Ω—å—è–∫,",
"–í–æ—Ç —Ç–≤–æ—ë –≥–æ–≤–Ω–æ... –æ–π, '–≤–∏–¥–µ–æ'. –î–µ—Ä–∂–∏,",
"–û–ø—è—Ç—å? –°—É–∫–∞, –¥–∞ —Ç—ã —Å–ø–∞–º–µ—Ä! –õ–∞–¥–Ω–æ, –ª–æ–≤–∏,",
"–ù—É —á—ë, –∏–¥–∏–æ—Ç, —Å–∫–∞—á–∞–ª - —Ç–µ–ø–µ—Ä—å –∏–¥–∏ —Å–ø–∞–º—å,",
"–ë–ª—è, –Ω—É —Ö–≤–∞—Ç–∏—Ç! –í–æ—Ç —Ç–≤–æ–π –≤–∏–¥–æ—Å, –æ—Ç—ä–µ–±–∏—Å—å,",
"–¢—ã —Ä–µ–∞–ª—å–Ω–æ –¥—É–º–∞–µ—à—å —ç—Ç–æ—Ç –∫–ª–∏–ø —Å—Ç–æ–∏—Ç –≤—Ä–µ–º–µ–Ω–∏? –ù—É –æ–∫,",
"–õ–æ–≤–∏, –¥–µ–±–∏–ª. –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –æ–ø—è—Ç—å –º–µ–º—ã - —è –≤ —à–æ–∫–µ,",
"–û, –¥–∞ —ç—Ç–æ –∂–µ —Ç–≤–æ–π 1000-–π —Ä–µ–ª—Å! –¢—ã –ª–µ–≥–µ–Ω–¥–∞,",
"–ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å –∏–¥–∏ –Ω–∞—Ö—É–π, –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞,",
"–û–ø—è—Ç—å –∏–Ω—Å—Ç–∞? –î–∞ —Ç—ã, —Å—É–∫–∞, –∫–∞–∫ –∑–æ–º–±–∏,",
"–ù—É —á—ë, —Å–Ω–æ–≤–∞ –∫–∞–∫—É—é-—Ç–æ –¥–∏—á—å –∫–∞—á–∞–µ–º? –ù–∞, –¥–æ–ª–±–∞—ë–±,",
"–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –∫–∞—á–∞—é, –±–ª—è–¥—å! (—à—É—á—É, –∫–∏–¥–∞–π –µ—â—ë),",
"–° —Ç–∞–∫–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π —Ä–∏–ª—Å–æ–≤ —Ç—ã –º–æ–∂–µ—à—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç—å –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ—Å—Ç—å,",
"–° —Ç–∞–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é —Ç—ã —Å–∫–æ—Ä–æ –æ–±–≥–æ–Ω–∏—à—å –§–ª—ç—à–∞‚Ä¶ –ø–æ –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É,",
"–î–∞–∂–µ –ì–µ–Ω–¥–∞–ª—å—Ñ —Å–∫–∞–∑–∞–ª –±—ã: '–¢—ã –Ω–µ –ø—Ä–æ–π–¥—ë—à—å!' ‚Äî –º–∏–º–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞,",
"–ü–∞–º—è—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å—Ç—Ä–∞–¥–∞–µ—Ç –±–æ–ª—å—à–µ, —á–µ–º –í–∞–∫–∞–Ω–¥–∞ –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª–∞,",
"–ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —Ç—ã –∫–∞—á–∞–µ—à—å —Ä–∏–ª—Å, –≥–¥–µ-—Ç–æ –ø–ª–∞—á–µ—Ç –æ–¥–∏–Ω –¢–æ–Ω–∏ –°—Ç–∞—Ä–∫,",
"–¢—ã –Ω–µ –∏–∑–±—Ä–∞–Ω–Ω—ã–π, –ù–µ–æ, —Ç—ã –ø—Ä–æ—Å—Ç–æ –∑–∞–ª–∏–ø–∞–µ—à—å –≤ –æ–±—ë—Ä—Ç–∫—É –æ—Ç –º–∞—Ç—Ä–∏—Ü—ã,",
"–ö–æ–≥–¥–∞ —Ç—ã —Å–º–æ—Ç—Ä–∏—à—å —Ä–∏–ª—Å—ã ‚Äî –¥–∞–∂–µ –í–ª–∞—Å—Ç–µ–ª–∏–Ω –ö–æ–ª–µ—Ü –∫–∞–∂–µ—Ç—Å—è –∫–æ—Ä–æ—Ç–∫–∏–º,",
"–ú—Å—Ç–∏—Ç–µ–ª–∏ —Å–æ–±—Ä–∞–ª–∏—Å—å, —á—Ç–æ–±—ã —Å–ø–∞—Å—Ç–∏ –ø–ª–∞–Ω–µ—Ç—É. –ê —Ç—ã ‚Äî —á—Ç–æ–±—ã —Å–∫–∞—á–∞—Ç—å —Ç–∞–Ω–µ—Ü –∏–∑ TikTok,",
"–ï—Å–ª–∏ –±—ã –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –±—ã–ª —Å—É–ø–µ—Ä—Å–∏–ª–æ–π ‚Äî —Ç—ã –±—ã–ª –±—ã –ë—ç—Ç–º–µ–Ω –±–µ–∑ –∫–æ—Å—Ç—é–º–∞ –∏ –¥–µ–Ω–µ–≥,",
"–¢—ã –æ—Ç–∫—Ä—ã–ª –ø–æ—Ä—Ç–∞–ª. –ù–æ –Ω–µ –≤ –º—É–ª—å—Ç–∏–≤—Å–µ–ª–µ–Ω–Ω—É—é, –∞ –≤ –∫—Ä–∏–Ω–∂-–±–µ–∑—É–º–∏–µ,",
"–û–¥–∏–Ω —Ç—ã —Å–ø–æ—Å–æ–±–µ–Ω –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å 30 –ì–ë –Ω–∞ –º–µ–º—ã –∏ –æ—Å—Ç–∞—Ç—å—Å—è –¥–æ–≤–æ–ª—å–Ω—ã–º,",
"–ï—Å–ª–∏ –±—ã –ª–µ–Ω—å –±—ã–ª–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º ‚Äî –æ–Ω–∞ –±—ã –≤—ã–≥–ª—è–¥–µ–ª–∞ —Ç–æ—á–Ω–æ –∫–∞–∫ —Ç–≤–æ—è –≥–∞–ª–µ—Ä–µ—è,",
"–ó–Ω–∞–µ—à—å, –∫—Ç–æ —Ç–æ–∂–µ –¥—É–º–∞–ª, —á—Ç–æ –≤—Å—ë –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º? –¢–∏—Ç–∞–Ω–∏–∫,",
"–¢–≤–æ—ë —á—É–≤—Å—Ç–≤–æ –≤–∫—É—Å–∞ ‚Äî –∫–∞–∫ —Å—é–∂–µ—Ç —É –§–æ—Ä—Å–∞–∂–∞ –ø–æ—Å–ª–µ 5-–π —á–∞—Å—Ç–∏,",
"–≠—Ç–æ—Ç –∫–ª–∏–ø ‚Äî –ø—Ä—è–º –∫–∞–∫ –Ω–æ–≤—ã–π —Å–µ–∑–æ–Ω '–í–µ–¥—å–º–∞–∫–∞': –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–æ—Å–∏–ª, –Ω–æ –≤–æ—Ç –æ–Ω,",
"–¢—ã –∫–∞—á–∞–µ—à—å —Ç–∞–∫, –±—É–¥—Ç–æ –∑–∞–≤—Ç—Ä–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –æ—Ç–∫–ª—é—á–∞—Ç –Ω–∞–≤—Å–µ–≥–¥–∞,",
"–í —Ç–µ–±–µ —Å—Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑—ã, —Å–∫–æ–ª—å–∫–æ –≤ —Å—Ü–µ–Ω–∞—Ö –ø–æ—Å–ª–µ —Ç–∏—Ç—Ä–æ–≤ —É –Ω–µ—É–¥–∞–≤—à–∏—Ö—Å—è —Ñ–∏–ª—å–º–æ–≤,",
"–î–∞–∂–µ –î–∞—Ä—Ç–∞ –í–µ–π–¥–µ—Ä–∞ –±—ã –∑–∞–¥—É—à–∏–ª–æ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫—Ä–∏–Ω–∂–∞ –≤ —Ç–≤–æ—ë–º —Ç–µ–ª–µ—Ñ–æ–Ω–µ,",
"–¢—ã ‚Äî —Ö–æ–¥—è—á–∏–π –ø—Ä–æ–ª–æ–≥ –∫ —Ñ–∏–ª—å–º—É, –∫–æ—Ç–æ—Ä—ã–π –Ω–∏–∫—Ç–æ –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Å–º–æ—Ç—Ä–µ—Ç—å,",
"–°–∫–æ—Ä–æ—Å—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —É —Ç–µ–±—è –∫–∞–∫ —É –§–ª—ç—à–∞, –∞ —Å–º—ã—Å–ª ‚Äî –∫–∞–∫ —É –ü–∞—Ç—Ä–∏–∫–∞ –∏–∑ '–°–ø–∞–Ω—á –ë–æ–±–∞',",
"–ö–∞–∂–¥–æ–µ —Ç–≤–æ—ë –¥–µ–π—Å—Ç–≤–∏–µ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ ‚Äî —ç—Ç–æ —É–¥–∞–ª—ë–Ω–Ω–∞—è —Å—Ü–µ–Ω–∞ –∏–∑ '–î—É—Ä–Ω—É—à–∫–∏ –ë–µ—Ç—Ç–∏',",
"–ï—Å–ª–∏ –±—ã –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –æ—Ü–µ–Ω–∏–≤–∞–ª–∏ –ø–æ –≥–∞–ª–µ—Ä–µ–µ, —Ç—ã –±—ã –Ω–µ –ø—Ä–æ—à—ë–ª –∫–∞—Å—Ç–∏–Ω–≥ –¥–∞–∂–µ –≤ '–î–æ–º-2',",
"–≠—Ç–æ—Ç –≤–∏–¥–æ—Å —Ç–µ–±—è –Ω–µ —Å–ø–∞—Å—ë—Ç, –∫–∞–∫ –∏ —Å—Ü–µ–Ω–∞, –≤—ã—Ä–µ–∑–∞–Ω–Ω–∞—è –∏–∑ '–ó–≤—ë–∑–¥–Ω—ã—Ö –≤–æ–π–Ω',",
"–¢—ã —Ç—Ä–∞—Ç–∏—à—å –≤—Ä–µ–º—è, –∫–∞–∫ –î–∂–æ–∫–µ—Ä —Ç—Ä–∞—Ç–∏—Ç –±–µ–Ω–∑–∏–Ω ‚Äî –∫—Ä–∞—Å–∏–≤–æ, –Ω–æ —Å –æ–≥–Ω—ë–º –∏ –±–µ–∑ —Ü–µ–ª–∏,",
"–¢—ã ‚Äî –∫–∞–∫ —Ç—Ä–µ—Ç–∏–π —Å–µ–∑–æ–Ω –ª—é–±–æ–≥–æ —Å–µ—Ä–∏–∞–ª–∞ Netflix: –≤—Ä–æ–¥–µ –µ—Å—Ç—å, –Ω–æ –ª—É—á—à–µ –±—ã –Ω–µ –±—ã–ª–æ,",
"–ö–∞–∂–¥—ã–π —Ç–≤–æ–π –≤—ã–±–æ—Ä ‚Äî –∫–∞–∫ –ø–æ–≤–æ—Ä–æ—Ç –≤ —Ñ–∏–ª—å–º–∞—Ö –®—å—è–º–∞–ª–∞–Ω–∞: —Å—Ç—Ä–∞–Ω–Ω–æ –∏ –±–µ–∑ –ª–æ–≥–∏–∫–∏,",
"–¢—ã –¥—É–º–∞–µ—à—å, —á—Ç–æ –∫–∞—á–∞–µ—à—å –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ. –°–ø–æ–π–ª–µ—Ä: –Ω–µ—Ç,",
"–î–∞–∂–µ –°—Ç—Ä—ç–Ω–¥–∂ –±—ã –Ω–µ —Å–º–æ–≥ —É–≤–∏–¥–µ—Ç—å —Ç–∞–π–º–ª–∞–π–Ω, –≥–¥–µ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –∫–ª–∏–ø –ø–æ –¥–µ–ª—É,",
"–¢—ã –±—ã –∏–¥–µ–∞–ª—å–Ω–æ –≤–ø–∏—Å–∞–ª—Å—è –≤ —Ñ–æ–Ω '–ò–≥—Ä—ã –ø—Ä–µ—Å—Ç–æ–ª–æ–≤' ‚Äî –≥–¥–µ –≤—Å—ë –∫—Ä–∞—Å–∏–≤–æ, –Ω–æ –≤—Å–µ–º –ø–ª–µ–≤–∞—Ç—å,",
"–≠—Ç–æ—Ç —Ñ–∞–π–ª –Ω–µ –∏–∑–º–µ–Ω–∏—Ç —Ç–≤–æ—é –∂–∏–∑–Ω—å, –∫–∞–∫ –∏ 73 –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö,",
"–ï—Å–ª–∏ –±—ã –≤–∏–¥–µ–æ –±—ã–ª–∏ –¥–µ–ª–æ–º –∂–∏–∑–Ω–∏, —Ç—ã –±—ã —É–∂–µ –ø–æ–ª—É—á–∏–ª –û—Å–∫–∞—Ä –∑–∞ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç—å,",
"–£—Ä–æ–≤–µ–Ω—å –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏: —Å–º–æ—Ç—Ä–∏—à—å –º–µ–º—ã –∏ –¥—É–º–∞–µ—à—å, —á—Ç–æ —É—á–∏—à—å—Å—è –∂–∏–∑–Ω–∏,",
"–¢—ã –∫–∞—á–∞–µ—à—å —Ç–∞–∫, –±—É–¥—Ç–æ –≥–¥–µ-—Ç–æ –∑–∞ —ç—Ç–æ –¥–∞—é—Ç –±–æ–Ω—É—Å—ã –≤ –∞–¥—É,",
"–ù–∏–∫ –§—å—é—Ä–∏ –±—ã –¥–∞–∂–µ –Ω–µ —Å—Ç–∞–ª —Ç–µ–±—è –≤–µ—Ä–±–æ–≤–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥—É, —Ç–æ–ª—å–∫–æ –∑–∞–±–∞–Ω–∏–ª,",
"–¢—ã ‚Äî —ç—Ç–æ –æ—à–∏–±–∫–∞ –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏ Marvel, –∫–æ—Ç–æ—Ä—É—é –∑–∞–±—ã–ª–∏ –≤—ã—Ä–µ–∑–∞—Ç—å,",
"–ï—Å–ª–∏ –±—ã —Ç–µ–ª–µ—Ñ–æ–Ω —É–º–µ–ª –≥–æ–≤–æ—Ä–∏—Ç—å, –æ–Ω –±—ã –ø–æ–¥–∞–ª –≤ —Å—É–¥ –∑–∞ –Ω–∞—Å–∏–ª–∏–µ –º–µ–º–∞–º–∏,",
"–≠—Ç–æ—Ç —Ñ–∞–π–ª ‚Äî –∫–∞–∫ –î–∂–∞—Ä-–î–∂–∞—Ä –ë–∏–Ω–∫—Å: –¥–∞–∂–µ —Ñ–∞–Ω–∞—Ç—ã –Ω–µ —Ö–æ—Ç—è—Ç –µ–≥–æ –≤–∏–¥–µ—Ç—å,",
"–¢—ã ‚Äî –∫–∞–∫ —Ñ–æ–Ω –≤ '–û—á–µ–Ω—å —Å—Ç—Ä–∞–Ω–Ω—ã—Ö –¥–µ–ª–∞—Ö': —à—É–º–Ω—ã–π, —Å—Ç—Ä–∞–Ω–Ω—ã–π –∏ –Ω–∏–∫–æ–º—É –Ω–µ –Ω—É–∂–Ω—ã–π,",
"–¢–µ–±—è –¥–∞–∂–µ –≤ '–ß—ë—Ä–Ω–æ–º –∑–µ—Ä–∫–∞–ª–µ' –ø–æ–∫–∞–∑–∞–ª–∏ –±—ã –∫–∞–∫ '–≤–æ—Ç —Ç–∞–∫ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω–∞–¥–æ',",
"–¢—ã –∫–∞—á–∞–µ—à—å –≤–∏–¥–µ–æ —Å —Ç–∞–∫–æ–π —Å—Ç—Ä–∞—Å—Ç—å—é, –±—É–¥—Ç–æ –ø—ã—Ç–∞–µ—à—å—Å—è –≤—ã–∑–≤–∞—Ç—å –ö—Ç—É–ª—Ö—É,",
"–ï—Å–ª–∏ –±—ã –±—ã–ª —Å–µ—Ä–∏–∞–ª '–ö–∞–∫ –≤—Å—ë –∏—Å–ø–æ—Ä—Ç–∏—Ç—å' ‚Äî —Ç—ã –±—ã–ª –±—ã –ø–∏–ª–æ—Ç–Ω–æ–π —Å–µ—Ä–∏–µ–π,",
]

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("üëã –ü—Ä–∏–≤–µ—Ç! –û—Ç–ø—Ä–∞–≤—å —Å—Å—ã–ª–∫—É –∏–∑ Instagram.", reply_markup=ReplyKeyboardMarkup([["/help"]], resize_keyboard=True))

async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("üì• –û—Ç–ø—Ä–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø–æ—Å—Ç –∏–ª–∏ Reels –∏–∑ Instagram, –∏ —è —Å–∫–∞—á–∞—é –≤–∏–¥–µ–æ –¥–ª—è —Ç–µ–±—è.")

async def handle_link(update: Update, context: ContextTypes.DEFAULT_TYPE):
    url = update.message.text.strip()
    user_id = update.message.from_user.id

    if "instagram.com" not in url:
        await update.message.reply_text("‚ö†Ô∏è –≠—Ç–æ –Ω–µ Instagram-—Å—Å—ã–ª–∫–∞.")
        return

    ##user_links_count[user_id] = user_links_count.get(user_id, 0) + 1
    ##if user_links_count[user_id] >= 5:
        ##await update.message.reply_text("üß† –ë—Ä–æ, –æ—Ç–¥–æ—Ö–Ω–∏ –æ—Ç Instagram –Ω–∞ –ø–∞—Ä—É –º–∏–Ω—É—Ç üòÑ")
        ##return

    await update.message.reply_text(random.choice(before_download))

    try:
        ydl_opts = {
            'outtmpl': 'insta_video.mp4',
            'format': 'mp4',
            'quiet': True,
            'noplaylist': True,
            'http_headers': {
                'User-Agent': 'Mozilla/5.0',
                'Accept-Language': 'en-US,en;q=0.9',
                'Cookie': COOKIES_STRING
            }
        }

        with yt_dlp.YoutubeDL(ydl_opts) as ydl:
            ydl.download([url])

        if os.path.getsize("insta_video.mp4") > 50_000_000:
            os.remove("insta_video.mp4")
            await update.message.reply_text("‚ö†Ô∏è –í–∏–¥–µ–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ –¥–ª—è Telegram (>50MB).")
            return

        with open("insta_video.mp4", "rb") as f:
            await update.message.reply_video(f)
        os.remove("insta_video.mp4")
        await update.message.reply_text(random.choice(after_download))

    except Exception as e:
        logging.error(str(e))
        await update.message.reply_text("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ. –ü—Ä–æ–≤–µ—Ä—å —Å—Å—ã–ª–∫—É –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ.")

flask_app = Flask(__name__)

@flask_app.route('/')
def home():
    return "‚úÖ –ë–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!"

def run_flask():
    flask_app.run(host="0.0.0.0", port=8000)

def run():
    app = ApplicationBuilder().token(BOT_TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("help", help_command))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_link))
    app.run_polling()

if __name__ == '__main__':
    Thread(target=run_flask, daemon=True).start()
    run()
